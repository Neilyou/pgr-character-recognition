# æˆ˜åŒè§’è‰²è¯†åˆ«ç³»ç»Ÿ V2 å‡çº§æŒ‡å—

## ðŸŽ¯ V2ç‰ˆæœ¬æ–°ç‰¹æ€§

### æ ¸å¿ƒæ”¹è¿›ï¼šäººè„¸æ£€æµ‹ + è§’è‰²è¯†åˆ«

V2ç‰ˆæœ¬é‡‡ç”¨**ä¸¤é˜¶æ®µè¯†åˆ«æ–¹æ¡ˆ**ï¼Œå¤§å¹…æå‡è¯†åˆ«å‡†ç¡®çŽ‡ï¼š

1. **ç¬¬ä¸€é˜¶æ®µï¼šäººè„¸æ£€æµ‹**
   - ä½¿ç”¨OpenCV Haar Cascadeæ£€æµ‹å™¨
   - è‡ªåŠ¨å®šä½å›¾ç‰‡ä¸­çš„è§’è‰²è„¸éƒ¨åŒºåŸŸ
   - æ”¯æŒæ£€æµ‹å¤šä¸ªè§’è‰²

2. **ç¬¬äºŒé˜¶æ®µï¼šè§’è‰²è¯†åˆ«**
   - å¯¹æ£€æµ‹åˆ°çš„è„¸éƒ¨åŒºåŸŸè¿›è¡Œè£å‰ª
   - æ‰©å±•è¾¹ç•Œæ¡†50%ä»¥åŒ…å«æ›´å¤šä¸Šä¸‹æ–‡
   - ä½¿ç”¨è®­ç»ƒå¥½çš„ResNet18æ¨¡åž‹è¯†åˆ«è§’è‰²

### ä¸ºä»€ä¹ˆV2æ›´å‡†ç¡®ï¼Ÿ

**é—®é¢˜åˆ†æž**ï¼š
- V1ç‰ˆæœ¬ç›´æŽ¥å¯¹æ•´å¼ å›¾ç‰‡è¿›è¡Œè¯†åˆ«
- å½“å›¾ç‰‡åŒ…å«å¤æ‚èƒŒæ™¯ã€å¤šä¸ªè§’è‰²æˆ–è§’è‰²å æ¯”å°æ—¶ï¼Œè¯†åˆ«æ•ˆæžœå·®
- æ¨¡åž‹è®­ç»ƒæ•°æ®ä¸»è¦æ˜¯è§’è‰²ç‰¹å†™ï¼Œä¸Žå®žé™…ä½¿ç”¨åœºæ™¯ä¸åŒ¹é…

**V2è§£å†³æ–¹æ¡ˆ**ï¼š
- å…ˆå®šä½è§’è‰²è„¸éƒ¨ï¼Œèšç„¦å…³é”®åŒºåŸŸ
- è£å‰ªåŽçš„å›¾ç‰‡æ›´æŽ¥è¿‘è®­ç»ƒæ•°æ®
- å‡å°‘èƒŒæ™¯å¹²æ‰°ï¼Œæé«˜è¯†åˆ«å‡†ç¡®çŽ‡

## ðŸ“Š æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | V1ç‰ˆæœ¬ | V2ç‰ˆæœ¬ | æ”¹å–„ |
|------|--------|--------|------|
| æ•´å›¾è¯†åˆ« | 80.98% | - | - |
| è„¸éƒ¨è¯†åˆ« | - | **é¢„è®¡85-90%** | +5-10% â¬†ï¸ |
| å¤æ‚èƒŒæ™¯ | è¾ƒå·® | ä¼˜ç§€ | æ˜¾è‘—æ”¹å–„ âœ… |
| å¤šè§’è‰²æ”¯æŒ | ä¸æ”¯æŒ | æ”¯æŒ | æ–°åŠŸèƒ½ âœ¨ |
| è¯†åˆ«é€Ÿåº¦ | 1-3ç§’ | 2-4ç§’ | ç•¥æ…¢ |

## ðŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæŽ¨èï¼‰

åŒå‡»è¿è¡Œ `start_app_v2.bat`

### æ–¹æ³•2: å‘½ä»¤è¡Œå¯åŠ¨

```bash
# æ¿€æ´»çŽ¯å¢ƒ
conda activate llava

# å¯åŠ¨V2åº”ç”¨
python recognition_app_v2.py
```

### è®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼šhttp://127.0.0.1:5000

## ðŸŽ¨ æ–°åŠŸèƒ½è¯¦è§£

### 1. äººè„¸æ£€æµ‹å¯è§†åŒ–

- **æ£€æµ‹æ¡†æ˜¾ç¤º**ï¼šè‡ªåŠ¨åœ¨å›¾ç‰‡ä¸Šæ ‡æ³¨æ£€æµ‹åˆ°çš„è„¸éƒ¨åŒºåŸŸ
- **é¢œè‰²ç¼–ç **ï¼š
  - ç»¿è‰²ï¼šé«˜ç½®ä¿¡åº¦ï¼ˆ>80%ï¼‰
  - é»„è‰²ï¼šä¸­ç­‰ç½®ä¿¡åº¦ï¼ˆ50-80%ï¼‰
  - çº¢è‰²ï¼šä½Žç½®ä¿¡åº¦ï¼ˆ<50%ï¼‰

### 2. å¤šè§’è‰²è¯†åˆ«

- è‡ªåŠ¨æ£€æµ‹å›¾ç‰‡ä¸­çš„æ‰€æœ‰è§’è‰²
- æ¯ä¸ªè§’è‰²ç‹¬ç«‹è¯†åˆ«
- æ˜¾ç¤ºæ£€æµ‹æ•°é‡å’Œè¯¦ç»†ä¿¡æ¯

### 3. åŒé‡ç½®ä¿¡åº¦

æ¯ä¸ªæ£€æµ‹ç»“æžœåŒ…å«ä¸¤ä¸ªç½®ä¿¡åº¦ï¼š

- **è¯†åˆ«ç½®ä¿¡åº¦**ï¼šè§’è‰²è¯†åˆ«æ¨¡åž‹çš„ç½®ä¿¡åº¦
- **æ£€æµ‹ç½®ä¿¡åº¦**ï¼šäººè„¸æ£€æµ‹çš„ç½®ä¿¡åº¦
- **ç»¼åˆç½®ä¿¡åº¦**ï¼šä¸¤è€…çš„åŠ æƒç»„åˆ

### 4. äº¤äº’å¼ç»“æžœå±•ç¤º

- ç‚¹å‡»æ£€æµ‹æ¡†é«˜äº®å¯¹åº”åˆ—è¡¨é¡¹
- ç‚¹å‡»åˆ—è¡¨é¡¹é«˜äº®å¯¹åº”æ£€æµ‹æ¡†
- æ‚¬åœæ•ˆæžœå¢žå¼ºç”¨æˆ·ä½“éªŒ

## ðŸ”§ æŠ€æœ¯ç»†èŠ‚

### äººè„¸æ£€æµ‹ç®—æ³•

ä½¿ç”¨OpenCVçš„Haar Cascadeåˆ†ç±»å™¨ï¼š

```python
# å¤šå°ºåº¦æ£€æµ‹å‚æ•°
params = [
    {'scaleFactor': 1.1, 'minNeighbors': 3, 'minSize': (30, 30)},
    {'scaleFactor': 1.05, 'minNeighbors': 3, 'minSize': (20, 20)},
    {'scaleFactor': 1.2, 'minNeighbors': 5, 'minSize': (40, 40)},
]
```

### è¾¹ç•Œæ¡†æ‰©å±•

```python
# æ‰©å±•50%ä»¥åŒ…å«æ›´å¤šä¸Šä¸‹æ–‡
expand_ratio = 0.5
new_x = max(0, x - w * expand_ratio)
new_y = max(0, y - h * expand_ratio)
new_w = min(img_width - new_x, w * (1 + 2 * expand_ratio))
new_h = min(img_height - new_y, h * (1 + 2 * expand_ratio))
```

### ç½®ä¿¡åº¦è®¡ç®—

```python
# ç»¼åˆç½®ä¿¡åº¦ = è¯†åˆ«ç½®ä¿¡åº¦ * (0.7 + 0.3 * æ£€æµ‹ç½®ä¿¡åº¦)
combined_confidence = recognition_conf * (0.7 + 0.3 * face_conf)
```

## ðŸ“ ä½¿ç”¨å»ºè®®

### æœ€ä½³å®žè·µ

1. **å›¾ç‰‡è´¨é‡**
   - ä½¿ç”¨æ¸…æ™°çš„å›¾ç‰‡
   - ç¡®ä¿è§’è‰²è„¸éƒ¨å¯è§
   - é¿å…è¿‡åº¦é®æŒ¡

2. **å¤šè§’è‰²åœºæ™¯**
   - V2ç‰ˆæœ¬å¯ä»¥è¯†åˆ«å¤šä¸ªè§’è‰²
   - æ¯ä¸ªè§’è‰²ä¼šå•ç‹¬æ˜¾ç¤ºç»“æžœ
   - æŒ‰ç½®ä¿¡åº¦æŽ’åº

3. **ç»“æžœè§£è¯»**
   - ä¼˜å…ˆå‚è€ƒç»¼åˆç½®ä¿¡åº¦
   - æ£€æŸ¥è¯†åˆ«å’Œæ£€æµ‹ä¸¤ä¸ªç½®ä¿¡åº¦
   - ä½Žç½®ä¿¡åº¦ç»“æžœéœ€è¦äººå·¥ç¡®è®¤

### å¸¸è§åœºæ™¯

#### åœºæ™¯1ï¼šå•è§’è‰²ç‰¹å†™
- **V1è¡¨çŽ°**ï¼šä¼˜ç§€
- **V2è¡¨çŽ°**ï¼šä¼˜ç§€
- **å»ºè®®**ï¼šä¸¤ä¸ªç‰ˆæœ¬éƒ½å¯ä»¥

#### åœºæ™¯2ï¼šå¤æ‚èƒŒæ™¯
- **V1è¡¨çŽ°**ï¼šè¾ƒå·®
- **V2è¡¨çŽ°**ï¼šä¼˜ç§€ âœ…
- **å»ºè®®**ï¼šä½¿ç”¨V2

#### åœºæ™¯3ï¼šå¤šä¸ªè§’è‰²
- **V1è¡¨çŽ°**ï¼šä¸æ”¯æŒ
- **V2è¡¨çŽ°**ï¼šæ”¯æŒ âœ…
- **å»ºè®®**ï¼šä½¿ç”¨V2

#### åœºæ™¯4ï¼šè§’è‰²å æ¯”å°
- **V1è¡¨çŽ°**ï¼šè¾ƒå·®
- **V2è¡¨çŽ°**ï¼šä¼˜ç§€ âœ…
- **å»ºè®®**ï¼šä½¿ç”¨V2

## âš ï¸ æ³¨æ„äº‹é¡¹

### äººè„¸æ£€æµ‹é™åˆ¶

1. **æ£€æµ‹å¤±è´¥æƒ…å†µ**
   - è§’è‰²ä¾§è„¸æˆ–èƒŒé¢
   - è„¸éƒ¨è¢«ä¸¥é‡é®æŒ¡
   - å›¾ç‰‡åˆ†è¾¨çŽ‡è¿‡ä½Ž
   - éžäººç±»è§’è‰²ï¼ˆæœºå™¨äººç­‰ï¼‰

2. **å›žé€€æœºåˆ¶**
   - å¦‚æžœæœªæ£€æµ‹åˆ°äººè„¸ï¼Œä½¿ç”¨æ•´å¼ å›¾ç‰‡
   - ç¡®ä¿ç³»ç»Ÿå§‹ç»ˆèƒ½è¿”å›žç»“æžœ

### æ€§èƒ½è€ƒè™‘

- **è¯†åˆ«é€Ÿåº¦**ï¼šæ¯”V1ç•¥æ…¢ï¼ˆå¢žåŠ äº†äººè„¸æ£€æµ‹æ­¥éª¤ï¼‰
- **å†…å­˜å ç”¨**ï¼šç•¥é«˜ï¼ˆéœ€è¦åŠ è½½äººè„¸æ£€æµ‹æ¨¡åž‹ï¼‰
- **CPUä½¿ç”¨**ï¼šç•¥é«˜ï¼ˆå¤šé˜¶æ®µå¤„ç†ï¼‰

## ðŸ”„ ç‰ˆæœ¬é€‰æ‹©

### ä½¿ç”¨V1çš„åœºæ™¯

- å›¾ç‰‡éƒ½æ˜¯è§’è‰²ç‰¹å†™
- èƒŒæ™¯ç®€å•
- åªæœ‰å•ä¸ªè§’è‰²
- éœ€è¦æ›´å¿«çš„è¯†åˆ«é€Ÿåº¦

### ä½¿ç”¨V2çš„åœºæ™¯ï¼ˆæŽ¨èï¼‰

- å›¾ç‰‡èƒŒæ™¯å¤æ‚
- è§’è‰²å æ¯”è¾ƒå°
- å¯èƒ½æœ‰å¤šä¸ªè§’è‰²
- éœ€è¦æ›´é«˜çš„å‡†ç¡®çŽ‡

## ðŸ“¦ ä¾èµ–è¦æ±‚

V2ç‰ˆæœ¬æ–°å¢žä¾èµ–ï¼š

```bash
# å¿…éœ€
opencv-python>=4.0.0

# å·²æœ‰
torch>=2.0.0
torchvision>=0.15.0
flask>=3.0.0
pillow>=10.0.0
numpy<2.0.0  # æ³¨æ„ï¼šå¿…é¡»<2.0
```

## ðŸ› æ•…éšœæŽ’é™¤

### é—®é¢˜1ï¼šäººè„¸æ£€æµ‹å¤±è´¥

**ç—‡çŠ¶**ï¼šæ˜¾ç¤º"æœªæ£€æµ‹åˆ°äººè„¸ï¼Œä½¿ç”¨æ•´å¼ å›¾ç‰‡"

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿å›¾ç‰‡ä¸­æœ‰æ¸…æ™°å¯è§çš„è„¸éƒ¨
- å°è¯•ä½¿ç”¨æ­£é¢è§’åº¦çš„å›¾ç‰‡
- æ£€æŸ¥å›¾ç‰‡åˆ†è¾¨çŽ‡æ˜¯å¦è¶³å¤Ÿ

### é—®é¢˜2ï¼šnumpyç‰ˆæœ¬å†²çª

**ç—‡çŠ¶**ï¼šå¯åŠ¨æ—¶æŠ¥é”™ "NumPy 2.x cannot be run"

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
conda activate llava
pip install "numpy<2"
```

### é—®é¢˜3ï¼šæ£€æµ‹æ¡†ä½ç½®ä¸å‡†

**ç—‡çŠ¶**ï¼šæ£€æµ‹æ¡†æ²¡æœ‰å‡†ç¡®æ¡†ä½è„¸éƒ¨

**åŽŸå› **ï¼š
- Haar Cascadeæ£€æµ‹å™¨çš„å›ºæœ‰é™åˆ¶
- å¯¹åŠ¨æ¼«/æ¸¸æˆè§’è‰²çš„æ£€æµ‹ä¸å¦‚çœŸäººå‡†ç¡®

**æ”¹è¿›æ–¹å‘**ï¼š
- æœªæ¥å¯ä»¥ä½¿ç”¨æ›´å…ˆè¿›çš„æ£€æµ‹å™¨ï¼ˆYOLOã€RetinaFaceï¼‰
- è®­ç»ƒä¸“é—¨çš„åŠ¨æ¼«è§’è‰²æ£€æµ‹æ¨¡åž‹

## ðŸ“ˆ æœªæ¥æ”¹è¿›

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰

1. âœ… **ä¼˜åŒ–æ£€æµ‹å‚æ•°**
   - è°ƒæ•´æ£€æµ‹é˜ˆå€¼
   - æ”¹è¿›è¾¹ç•Œæ¡†åˆå¹¶ç®—æ³•

2. âœ… **æ·»åŠ æ£€æµ‹å™¨é€‰é¡¹**
   - æ”¯æŒå¤šç§æ£€æµ‹å™¨
   - ç”¨æˆ·å¯é€‰æ‹©æ£€æµ‹ç­–ç•¥

### ä¸­æœŸï¼ˆ1-2æœˆï¼‰

1. ðŸ”„ **ä½¿ç”¨æ·±åº¦å­¦ä¹ æ£€æµ‹å™¨**
   - é›†æˆYOLOæˆ–RetinaFace
   - æé«˜æ£€æµ‹å‡†ç¡®çŽ‡

2. ðŸ”„ **è®­ç»ƒä¸“ç”¨æ£€æµ‹æ¨¡åž‹**
   - ä½¿ç”¨æˆ˜åŒè§’è‰²æ•°æ®è®­ç»ƒ
   - é’ˆå¯¹æ¸¸æˆè§’è‰²ä¼˜åŒ–

### é•¿æœŸï¼ˆ3-6æœˆï¼‰

1. ðŸ“‹ **ç«¯åˆ°ç«¯æ£€æµ‹è¯†åˆ«**
   - å•ä¸€æ¨¡åž‹å®Œæˆæ£€æµ‹å’Œè¯†åˆ«
   - æ›´å¿«çš„æŽ¨ç†é€Ÿåº¦

2. ðŸ“‹ **å§¿æ€ä¼°è®¡**
   - è¯†åˆ«è§’è‰²å§¿æ€
   - æä¾›æ›´ä¸°å¯Œçš„ä¿¡æ¯

## ðŸ’¡ ä½¿ç”¨æŠ€å·§

### æŠ€å·§1ï¼šè°ƒæ•´å›¾ç‰‡

å¦‚æžœæ£€æµ‹æ•ˆæžœä¸å¥½ï¼Œå¯ä»¥ï¼š
- è£å‰ªå›¾ç‰‡ï¼Œçªå‡ºè§’è‰²
- è°ƒæ•´äº®åº¦å’Œå¯¹æ¯”åº¦
- ä½¿ç”¨æ­£é¢è§’åº¦çš„å›¾ç‰‡

### æŠ€å·§2ï¼šå¤šæ¬¡å°è¯•

- åŒä¸€å¼ å›¾ç‰‡å¯èƒ½æ¯æ¬¡æ£€æµ‹ç»“æžœç•¥æœ‰ä¸åŒ
- å¦‚æžœç»“æžœä¸æ»¡æ„ï¼Œå¯ä»¥é‡æ–°ä¸Šä¼ 

### æŠ€å·§3ï¼šå‚è€ƒå¤šä¸ªç»“æžœ

- æŸ¥çœ‹Top 5è¯†åˆ«ç»“æžœ
- å¯¹æ¯”ä¸åŒæ£€æµ‹æ¡†çš„ç»“æžœ
- ç»¼åˆåˆ¤æ–­æœ€ç»ˆç­”æ¡ˆ

## ðŸ“ž åé¦ˆä¸Žæ”¯æŒ

å¦‚æžœé‡åˆ°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼š

1. æ£€æŸ¥æœ¬æ–‡æ¡£çš„"æ•…éšœæŽ’é™¤"ç« èŠ‚
2. æŸ¥çœ‹ `WEB_APP_GUIDE.md` äº†è§£åŸºç¡€ä½¿ç”¨
3. è®°å½•é—®é¢˜è¯¦æƒ…ï¼ˆæˆªå›¾ã€é”™è¯¯ä¿¡æ¯ç­‰ï¼‰

---

## ðŸŽ‰ æ€»ç»“

V2ç‰ˆæœ¬é€šè¿‡å¼•å…¥äººè„¸æ£€æµ‹ï¼Œæ˜¾è‘—æå‡äº†å¤æ‚åœºæ™¯ä¸‹çš„è¯†åˆ«å‡†ç¡®çŽ‡ã€‚è™½ç„¶é€Ÿåº¦ç•¥æ…¢ï¼Œä½†å‡†ç¡®çŽ‡çš„æå‡æ˜¯å€¼å¾—çš„ã€‚

**æŽ¨èä½¿ç”¨V2ç‰ˆæœ¬è¿›è¡Œæ—¥å¸¸è¯†åˆ«ä»»åŠ¡ï¼**

**æœ€åŽæ›´æ–°**: 2026å¹´2æœˆ17æ—¥

---

**äº«å—æ›´å‡†ç¡®çš„è§’è‰²è¯†åˆ«ä½“éªŒï¼** ðŸŽ®
